---
keep-typ: true
_quarto:
  render-project: true
  tests:
    ilm-typst:
      ensureTypstFileRegexMatches:
        - # matches array (first positional argument)
          - "test book for Typst output format"
          - "first chapter of the book"
          - "second chapter of the book"
          - "third chapter of the book"
          - "#heading\\(level: 1, numbering: none\\)\\[Preface\\]"
          - "<fig-cars>"
          - "<fig-visualization>"
          - "<tbl-data>"
          - "<sec-intro>"
          - "<sec-methods>"
          - "<sec-results>"
          # Section labels
          - "<sec-basic-figures>"
          - "<sec-embedded-notebooks>"
          - "<sec-callouts>"
          - "<sec-custom-crossref-dinosaurs>"
          - "<sec-equations>"
          - "<sec-theorems>"
          - "<sec-code-listings>"
          - "<sec-tables>"
          - "<sec-cross-references>"
          - "<sec-sub-figures>"
          - "<sec-more-callouts>"
          - "<sec-more-dinosaurs>"
          - "<sec-more-equations>"
          - "<sec-more-theorems>"
          - "<sec-more-code-listings>"
          - "#ref\\(<fig-cars>, supplement: \\[Figure\\]\\)"
          - "#ref\\(<fig-visualization>, supplement: \\[Figure\\]\\)"
          - "#ref\\(<tbl-data>, supplement: \\[Table\\]\\)"
          - "#ref\\(<sec-intro>, supplement: \\[Chapter\\]\\)"
          - "#ref\\(<sec-methods>, supplement: \\[Chapter\\]\\)"
          - "A plot of the cars dataset"
          - "Sample data table"
          - "#cite\\(<knuth84>"
          - '#bibliography\(\("references\.bib"\)\)'
          # ilm emits parts as unnumbered headings
          - "#heading\\(level: 1, numbering: none\\)\\[Part I: Getting Started\\]"
          - "#heading\\(level: 1, numbering: none\\)\\[Part II: Advanced Topics\\]"
          # ilm uses manual appendix setup (counter reset + appendix-state)
          - '#appendix-state\.update\(true\)'
          - '#counter\(heading\)\.update\(0\)'
          - "<sec-resources>"
          - "#quarto_super\\("
          - "<fig-panel>"
          - "<fig-panel-a>"
          - "<fig-panel-b>"
          - "#ref\\(<fig-panel>, supplement: \\[Figure\\]\\)"
          - "#ref\\(<fig-panel-a>, supplement: \\[Figure\\]\\)"
          - "#callout\\("
          - 'kind: "quarto-callout-Warning"'
          - 'kind: "quarto-callout-Tip"'
          - 'kind: "quarto-callout-Note"'
          - 'kind: "quarto-callout-Important"'
          - "<wrn-tea>"
          - "<tip-towel>"
          - "<nte-vogon>"
          - "<imp-answer>"
          - "#ref\\(<wrn-tea>, supplement: \\[Warning\\]\\)"
          - "#ref\\(<tip-towel>, supplement: \\[Tip\\]\\)"
          - "#ref\\(<nte-vogon>, supplement: \\[Note\\]\\)"
          - "#ref\\(<imp-answer>, supplement: \\[Important\\]\\)"
          - "<fig-appendix-panel>"
          - "<fig-appendix-panel-a>"
          - "<fig-appendix-panel-b>"
          - "#ref\\(<fig-appendix-panel>, supplement: \\[Figure\\]\\)"
          - "#ref\\(<fig-appendix-panel-a>, supplement: \\[Figure\\]\\)"
          - "<wrn-appendix>"
          - "<tip-appendix>"
          - "#ref\\(<wrn-appendix>, supplement: \\[Warning\\]\\)"
          - "#ref\\(<tip-appendix>, supplement: \\[Tip\\]\\)"
          - 'kind: "quarto-float-dino"'
          - "<dino-steg>"
          - "<dino-trex>"
          - "<dino-raptor>"
          - "<dino-ptero>"
          - "<dino-appendix>"
          - "<dino-appendix-b>"
          - "#ref\\(<dino-steg>, supplement: \\[Dinosaur\\]\\)"
          - "#ref\\(<dino-raptor>, supplement: \\[Dinosaur\\]\\)"
          - "#ref\\(<dino-appendix>, supplement: \\[Dinosaur\\]\\)"
          - "#ref\\(<dino-appendix-b>, supplement: \\[Dinosaur\\]\\)"
          - "<fig-appendix-b-panel>"
          - "<fig-appendix-b-panel-a>"
          - "<wrn-appendix-b>"
          - "<tip-appendix-b>"
          - "#ref\\(<fig-appendix-b-panel>, supplement: \\[Figure\\]\\)"
          - "#ref\\(<wrn-appendix-b>, supplement: \\[Warning\\]\\)"
          - 'counter\(figure\.where\(kind: "quarto-float-dino"\)\)\.update\(0\)'
          - "<eq-einstein>"
          - "<eq-newton>"
          - "<eq-quadratic>"
          - "<eq-pythagorean>"
          - "#ref\\(<eq-einstein>, supplement: \\[Equation\\]\\)"
          - "#ref\\(<eq-newton>, supplement: \\[Equation\\]\\)"
          - "#ref\\(<eq-quadratic>, supplement: \\[Equation\\]\\)"
          - "#ref\\(<eq-pythagorean>, supplement: \\[Equation\\]\\)"
          - 'math\.equation\(block: true, numbering: equation-numbering'
          - 'counter\(math\.equation\)\.update\(0\)'
          # ilm uses theorion for theorems
          - "#import \"@preview/theorion:0\\.4\\.1\": make-frame"
          - "simple-theorem-render"
          - '#show: show-theorem'
          - 'make-frame\(\s*"theorem"'
          - "<thm-pythagorean>"
          - "<lem-triangle>"
          - "<thm-calculus>"
          - "<def-continuous>"
          - "<thm-appendix>"
          - "#ref\\(<thm-pythagorean>"
          - "#ref\\(<lem-triangle>"
          - "#ref\\(<thm-calculus>"
          - "#ref\\(<thm-appendix>"
          - "<lst-hello>"
          - "<lst-fibonacci>"
          - "<lst-quicksort>"
          - "<lst-appendix-example>"
          - "#ref\\(<lst-hello>"
          - "#ref\\(<lst-fibonacci>"
          - "#ref\\(<lst-quicksort>"
          - "#ref\\(<lst-appendix-example>"
          - 'kind: "quarto-float-lst"'
          # ilm-specific import and show rules
          - '#import "@preview/ilm:1\.4\.2": ilm'
          - '#show: ilm\.with\('
      ensurePdfRegexMatches:
        - # matches array (first positional argument)
          - "Figure 1\\.1: A plot of the cars dataset"
          - "Figure 1\\.2: A display of a line"
          - "Table 2\\.1: Sample data table"
          - "Figure 2\\.1: A panel with two sub-figures"
          - "Some content in Section 1\\.1\\. See Figure 1\\.1"
          - "Some content in Section 1\\.2\\. See Figure 1\\.2"
          - "Some content in Section 2\\.1\\. See Table 2\\.1"
          - "Some content in Section 2\\.2\\. Refer back to Figure 1\\.1 and Table 2\\.1"
          # Section self-references (ilm adds trailing period to section numbers)
          - "Section 1\\.4\\.? tests custom cross-reference types"
          - "Section 2\\.5\\.? tests that custom cross-reference counters"
          - "Section A\\.3\\.? tests sub-figure numbering"
          - "Section A\\.4\\.? tests callout numbering"
          - "Section A\\.5\\.? tests custom cross-reference numbering"
          # ilm chapter numbers don't have trailing period (unlike orange-book)
          - "See Chapter 1 for the main introduction"
          - "As discussed in Chapter 1, we now\\s+present"
          - "See Figure 2\\.1 for a panel.*Figure 2\\.1a and Figure 2\\.1b"
          - "Recall the panel figure from Chapter 2: see Figure 2\\.1 for the complete\\s+panel"
          - "Figure 2\\.1a shows[\\s\\S]*second panel"
          - "reference the main figure from Chapter 1: Figure 1\\.1 shows the\\s+cars"
          - "Warning 1\\.1: Whose Tea Is This"
          - "Tip 2\\.1: Whose Towel Is This"
          - "Note 2\\.1: A Note About Vogon Poetry"
          - "Important 3\\.1: The Answer"
          - "See Warning 1\\.1 to reference this\\s+warning"
          - "See Tip 2\\.1 to reference this tip"
          - "See Note 2\\.1[\\s\\S]*to reference[\\s\\S]*this note"
          - "See Important 3\\.1[\\s\\S]*this important"
          - "see Warning 1\\.1"
          - "See Warning 1\\.1 for the tea warning"
          - "See Tip 2\\.1 for towel advice"
          - "See Note 2\\.1 for important information about Vogon poetry"
          - "Figure A\\.1: A panel of sub-figures in\\s+the appendix"
          - "See Figure A\\.1 for a panel of appendix sub-figures"
          - "Figure A\\.1a and[\\s\\S]*Figure A\\.1b"
          - "Warning A\\.1: Appendix Warning"
          - "Tip A\\.1: Appendix Tip"
          - "See Warning A\\.1 to reference this\\s+appendix warning"
          - "See Tip A\\.1[\\s\\S]*this appendix tip"
          - "See Figure A\\.1 for appendix sub-figures"
          - "See Warning A\\.1 for the appendix warning"
          - "See Tip A\\.1 for the appendix tip"
          - "see Warning 1\\.1[\\s\\S]*tea warning"
          - "Dinosaur 1\\.1: This is the first dinosaur"
          - "Dinosaur 1\\.2: This is the second di"
          - "Dinosaur 2\\.1: This dinosaur demon"
          - "Dinosaur 3\\.1: This flying reptile soared"
          - "Dinosaur A\\.1: This dinosaur in the"
          - "See Dinosaur 1\\.1\\s+to self"
          - "See\\s+Dinosaur 2\\.1 to self"
          - "see Dinosaur 1\\.1[\\s\\S]*Dinosaur 1\\.2 from Chapter"
          - "see Dinosaur 1\\.1 from Chapter 1 and\\s+Dinosaur 2\\.1"
          - "See Dinosaur A\\.1 for the appendix dinosaur"
          - "see Dinosaur 1\\.1 from Chapter 1"
          - "Figure B\\.1: A panel of sub-figures\\s+in Appendix B"
          - "Figure B\\.1a and Figure B\\.1b\\s+individually"
          - "Warning B\\.1: Appendix B Warning"
          - "Tip B\\.1: Appendix B Tip"
          - "Dinosaur B\\.1: This dinosaur in Appen"
          - "See[\\s\\S]*Dinosaur B\\.1 to self"
          - "See Figure B\\.1 for Appendix B sub-figures"
          - "See Warning B\\.1 for the Appendix B warning"
          - "See Tip B\\.1 for the Appendix B tip"
          - "See Dinosaur B\\.1 for the Appendix B dinosaur"
          - "see Figure A\\.1 for Appendix A"
          - "\\(1\\.1\\)"
          - "\\(1\\.2\\)"
          - "\\(2\\.1\\)"
          - "\\(A\\.1\\)"
          - "As shown in Equation \\(1\\.1\\), energy and mass"
          - "Newton.s second law \\(Equation \\(1\\.2\\)\\)"
          - "Use Equation \\(2\\.1\\) to solve quadratic equations"
          - "See Equation \\(A\\.1\\) for right triangles"
          - "Recall Equation \\(1\\.1\\) from Chapter 1 and Equa[\\s\\S]*\\(1\\.2\\)"
          - "Recall Equation \\(1\\.1\\) from Chapter 1 and Equa[\\s\\S]*\\(2\\.1\\)"
          - "Theorem 1\\.1.*Pythagorean"
          - "Lemma 1\\.1.*Triangle Inequality"
          - "Theorem 2\\.1.*Fundamental Theorem"
          - "Definition 2\\.1.*Continuous"
          - "See Theorem 1\\.1 for the classic result"
          - "See Lemma 1\\.1 for the inequality"
          - "See Theorem 2\\.1"
          - "See Definition 2\\.1 for the definition"
          - "Recall Theorem 1\\.1[\\s\\S]*Lemma[\\s\\S]*1\\.1 from Chapter 1"
          - "Listing 1\\.1.*Hello World"
          - "Listing 1\\.2.*Fibonacci"
          - "Listing 2\\.1.*Quicksort"
          - "Listing A\\.1.*Appendix Code Example"
          - "See Listing 1\\.1 for a simple Python example"
          - "Listing 1\\.2.*uses recursion"
          - "See Listing 2\\.1 for an efficient sorting algorithm"
          - "See Listing A\\.1 for an appendix code example"
          - "See Listing 1\\.1 and Listing 1\\.2 from Chapter 1"
          - "See Listing 1\\.1 from Chapter 1[\\s\\S]*Listing 2\\.1"
      ensurePdfTextPositions:
        - # Code listings should be left-aligned with body text, not centered.
          # NOTE: Subject must be text at the START of a line because
          # ensurePdfTextPositions uses word positions, not semantic containers.
          # Tolerance accounts for 8pt inset in Skylighting code blocks.
          - subject: "ALIGNTEST_MARKER"
            relation: leftAligned
            object: "LISTING_BODY_ALIGN_TEST"
            tolerance: 15
---

# Preface {.unnumbered}

This is a test book for Typst output format.

## About this book

This book tests the basic Typst book rendering functionality in Quarto.
See @knuth84 for additional discussion of literate programming.
